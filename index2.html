<!DOCTYPE html>
<html>

<HEAD>
    <TITLE>3d.felixjungo.ch</TITLE>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <link rel="stylesheet" href="style.css">
</HEAD>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<style>

</style>

<script>



    loadFile = function () {
        alert("loadFile");
        $("#openButton").empty()
        $("#openButton").append("<progress class='pure-material-progress-circular' />")
        if (navigator.userAgent.match('CriOS')) {
            setTimeout(finishedLoading(), 2000);
        } else {
            //window.addEventListener("visibilitychange", finishedLoading)
        }
    }


    $(document).ready(function () {
        console.log("ready!");
        if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
            // true for mobile device
            console.log("iphone:" + navigator.userAgent);
            $("#androidAR").empty();

            //$("#iOSAR").empty();
        } else if (/Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            // true for mobile device
            console.log("android:" + navigator.userAgent);
            $("#iOSAR").empty();
        } else {
            // false for not mobile device
            console.log("desktop:" + navigator.userAgent);
            $("#androidAR").empty();
        }
    });


</script>

<body>

    <div id="iOSAR" class="fullOn">
        <!-- 
        <a rel="ar" href="assets/KC_Vase_1.usdz" onload="alert('xxx')">
            <img src="assets/IMG_3897.JPG">
            <div id="openButton" class="openFile">
                click<br>click<br>click<br>click<br>click<br>click<br>click<br>click<br>click<br>click
            </div>
        </a> -->
    </div>


    <script>


        function fakeLoader() {

            $("#iOSAR").append("<div id='loadingDiv' class='loading'><progress class='pure-material-progress-circular' /></div>")

            //setInterval(checkFocus, 300);

            var myTimer = setInterval(checkFocus, 300);

            function checkFocus() {
                if (document.hasFocus()) {
                    console.log("hasfocus");
                }
                else {
                    console.log("has no focus");
                    $("#loadingDiv").remove();
                    clearInterval(myTimer);
                }
            }
        };

        // Check page focus every 300 milliseconds
        //setInterval(fakeLoader, 300);



        var iosLink = document.createElement("a");
        iosLink.type = "text/css";
        iosLink.rel = "ar";
        iosLink.id = "iosLink"
        iosLink.href = "assets/KC_Vase_1.usdz";
        iosLink.innerHTML = '<img src="assets/IMG_3897.JPG">';

        iosLink.src = "theDir/theFile.css";         // should immediately start to load.
        $("#iOSAR").append(iosLink);

        var a = document.getElementById("iosLink")
        a.onclick = function () {
            console.log("now");
            fakeLoader();
        }

    </script>

    <div id="androidAR">

        <model-viewer src="assets/vase_e_2.glb" alt="A 3D model of an astronaut" poster="assets/IMG_3897.JPG" ar
            ar-modes="webxr scene-viewer" reveal="interaction" environment-image="neutral" camera-controls>
            <button slot="ar-button" id="ar-button">
                View in your space
            </button>
        </model-viewer>
    </div>
</body>

</html>